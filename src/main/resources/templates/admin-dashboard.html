<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard | Clinic Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">
    <style>
        body { font-family: 'Poppins', sans-serif; background: #f0f4f8; }
        .nav-buttons { margin: 20px 0; text-align: center; }
        .nav-buttons button { margin: 0 10px; min-width: 150px; }
        .table-container { margin-top: 20px; }
        .btn-edit { background-color: #ffc107; color: white; }
        .modal-header { color: white; }
        .table-content { display: none; }
        tr:hover { background: #e0f7fa; transition: 0.3s; }
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container-fluid">
        <a class="navbar-brand" href="#">Clinic Admin</a>
        <div class="d-flex">
            <a href="/logout" class="btn btn-light me-2"><i class="fas fa-sign-out-alt"></i> Logout</a>
        </div>
    </div>
</nav>

<div class="container mt-4">

    <!-- Navigation Buttons -->
    <div class="nav-buttons">
        <button class="btn btn-primary" onclick="showTable('doctors')">Doctors</button>
        <button class="btn btn-success" onclick="showTable('patients')">Patients</button>
        <button class="btn btn-warning" onclick="showTable('appointments')">Appointments</button>
    </div>

    <!-- Doctors Table -->
    <div id="doctors" class="table-content">
        <div class="d-flex justify-content-between align-items-center mb-2">
            <h4>Doctors</h4>
            <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addDoctorModal">
                <i class="fas fa-plus"></i> Add Doctor
            </button>
        </div>
        <table class="table table-striped">
            <thead class="table-primary">
            <tr>
                <th>Name</th>
                <th>Surname</th>
                <th>Specialization</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="doctor : ${doctors}">
                <td th:text="${doctor.name}"></td>
                <td th:text="${doctor.surname}"></td>
                <td th:text="${doctor.specialization}"></td>
                <td>
                    <button class="btn btn-edit btn-sm" data-bs-toggle="modal"
                            th:attr="data-bs-target='#editDoctorModal__${doctor.id}'">Edit</button>
                    <a th:href="@{'/admin/delete-doctor/' + ${doctor.id}}" class="btn btn-danger btn-sm">Delete</a>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- Patients Table -->
    <div id="patients" class="table-content">
        <div class="d-flex justify-content-between align-items-center mb-2">
            <h4>Patients</h4>
            <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addPatientModal">
                <i class="fas fa-plus"></i> Add Patient
            </button>
        </div>
        <table class="table table-striped">
            <thead class="table-success">
            <tr>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Email</th>
                <th>Birthday</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="patient : ${patients}">
                <td th:text="${patient.firstName}"></td>
                <td th:text="${patient.lastName}"></td>
                <td th:text="${patient.email}"></td>
                <td th:text="${patient.birthday}"></td>
                <td>
                    <button class="btn btn-edit btn-sm" data-bs-toggle="modal"
                            th:attr="data-bs-target='#editPatientModal__${patient.id}'">Edit</button>
                    <a th:href="@{'/admin/delete-patient/' + ${patient.id}}" class="btn btn-danger btn-sm">Delete</a>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- Appointments Table -->
    <div id="appointments" class="table-content">
        <div class="d-flex justify-content-between align-items-center mb-2">
            <h4>Appointments</h4>
            <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addAppointmentModal">
                <i class="fas fa-plus"></i> Add Appointment
            </button>
        </div>
        <table class="table table-striped">
            <thead class="table-warning">
            <tr>
                <th>Doctor</th>
                <th>Patient</th>
                <th>Date</th>
                <th>Room</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="appointment : ${appointments}">
                <td th:text="${appointment.doctor.name + ' ' + appointment.doctor.surname}"></td>
                <td th:text="${appointment.patient.firstName + ' ' + appointment.patient.lastName}"></td>
                <td th:text="${appointment.localDate}"></td>
                <td th:text="${appointment.room}"></td>
                <td>
                    <button class="btn btn-edit btn-sm" data-bs-toggle="modal"
                            th:attr="data-bs-target='#editAppointmentModal__${appointment.id}'">Edit</button>
                    <a th:href="@{'/admin/delete-appointment/' + ${appointment.id}}" class="btn btn-danger btn-sm">Delete</a>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

</div>

<!-- MODALS: ADD -->
<!-- Doctor -->
<div class="modal fade" id="addDoctorModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title">Add Doctor</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form th:action="@{/admin/save-doctor}" th:object="${doctor}" method="post">
                    <div class="mb-3"><label>Name</label><input type="text" th:field="*{name}" class="form-control" required></div>
                    <div class="mb-3"><label>Surname</label><input type="text" th:field="*{surname}" class="form-control" required></div>
                    <div class="mb-3"><label>Specialization</label><input type="text" th:field="*{specialization}" class="form-control" required></div>
                    <button type="submit" class="btn btn-success w-100">Save</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Patient -->
<div class="modal fade" id="addPatientModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-success text-white">
                <h5 class="modal-title">Add Patient</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form th:action="@{/admin/save-patient}" th:object="${patient}" method="post">
                    <div class="mb-3"><label>First Name</label><input type="text" th:field="*{firstName}" class="form-control" required></div>
                    <div class="mb-3"><label>Last Name</label><input type="text" th:field="*{lastName}" class="form-control" required></div>
                    <div class="mb-3"><label>Email</label><input type="email" th:field="*{email}" class="form-control" required></div>
                    <div class="mb-3"><label>Birthday</label><input type="date" th:field="*{birthday}" class="form-control" required></div>
                    <button type="submit" class="btn btn-success w-100">Save</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Appointment -->
<div class="modal fade" id="addAppointmentModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-warning text-dark">
                <h5 class="modal-title">Add Appointment</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form th:action="@{/admin/save-appointment}" th:object="${appointment}" method="post">
                    <div class="mb-3">
                        <label>Doctor</label>
                        <select th:field="*{doctor.id}" class="form-select" required>
                            <option th:each="d : ${doctors}" th:value="${d.id}" th:text="${d.name + ' ' + d.surname}"></option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label>Patient</label>
                        <select th:field="*{patient.id}" class="form-select" required>
                            <option th:each="p : ${patients}" th:value="${p.id}" th:text="${p.firstName + ' ' + p.lastName}"></option>
                        </select>
                    </div>
                    <div class="mb-3"><label>Date</label><input type="date" th:field="*{localDate}" class="form-control" required></div>
                    <div class="mb-3"><label>Room</label><input type="text" th:field="*{room}" class="form-control" required></div>
                    <button type="submit" class="btn btn-success w-100">Save</button>
                </form>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
    function showTable(tableId) {
        document.querySelectorAll('.table-content').forEach(t => t.style.display = 'none');
        document.getElementById(tableId).style.display = 'block';
    }
    showTable('doctors'); // default
</script>

</body>
</html>
